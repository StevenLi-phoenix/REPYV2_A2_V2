# bm3792_attackcase12.r2py
# Test: Try to write to base file after versions are created

f1 = openfile("testfile", True)
f1.writeat("original", 0)
f1.close()

# Create version 1
f2 = openfile("testfile", True)
f2.close()

# Try to open and write to base file
try:
    base = openfile("testfile", False)
    base.writeat("hacked", 0)
    base.close()
    
    # Check if modification succeeded
    check = openfile("testfile", False)
    content = check.readat(None, 0)
    check.close()
    
    if content == "hacked":
        log("SECURITY BUG: Modified base file after version created\n")
except:
    pass

# Test immutability
f = openfile("immutable", True)
f.writeat("v0", 0)
f.close()

# Create version
f = openfile("immutable", True)
f.writeat("v1", 0)
f.close()

# Try to open and write to old version
fold = openfile("immutable", False)
try:
    fold.writeat("hack", 0)
    log("ERROR: Should not be able to write to old version\n")
    exitall()
except FileInUseError:
    log("PASS: Old version is immutable\n")
fold.close()
